<!DOCTYPE HTML>
<html>

<head>
    <title>pixi.js example 1</title>
    <style>
    body {
        margin: 0;
        padding: 0;
        /*background-color: #000000;*/
    }
    </style>
    <script src="pixi.js"></script>
</head>

<body>
    <script>
    const RADIUS = 10;
    const NUM_POLYGON = 50;
    const REALDATA = false;


    var blue_canvas = document.createElement('canvas');
    blue_canvas.width = RADIUS << 1;
    blue_canvas.height = RADIUS << 1;
    var blue_context = blue_canvas.getContext('2d');
    blue_context.beginPath();
    blue_context.arc(RADIUS, RADIUS, RADIUS, 0, 2 * Math.PI, true);
    blue_context.fillStyle = 'blue';
    blue_context.fill();
    blue_context.lineWidth = 1;
    blue_context.strokeStyle = '#003300';
    blue_context.stroke();
    blue_context.closePath();

    blue_context.beginPath();
    blue_context.moveTo(0, 0);
    blue_context.lineTo(0, blue_canvas.height);
    blue_context.lineTo(blue_canvas.width, blue_canvas.height);
    blue_context.lineTo(blue_canvas.width, 0);
    blue_context.closePath();
    blue_context.stroke();

    var img_blueCircle = new Image();
    img_blueCircle.src = blue_canvas.toDataURL("image/png");

    var startTime = new Date();

    const NUMDRAW = 1000000;

    var renderer = new PIXI.CanvasRenderer(800, 600, {
    // var renderer = new PIXI.WebGLRenderer(800, 600, {
        transparent: true,
    });
    document.body.appendChild(renderer.view);

    var texture = PIXI.Texture.fromCanvas(blue_canvas);

    // var container = new PIXI.ParticleContainer(NUMDRAW, [false, false, false, false, false], NUMDRAW);
    var container = new PIXI.Container();

    var sprites = [];
    for (var i = 0; i < NUMDRAW; i++) {

        var x = Math.round(i * Math.random() + 50) % renderer.width;
        var y = Math.round(i * Math.random() + 50) % renderer.height;

        if (x > renderer.width || y > renderer.height) {
            continue;
        }

        sprite = new PIXI.Sprite(texture);

        sprite.position.x = x;
        sprite.position.y = y;


        sprite.anchor.x = 0.5;
        sprite.anchor.y = 0.5;


        sprites.push(sprite);

        container.addChild(sprite);
    }

    console.time('render');
    renderer.render(container);
    console.timeEnd('render');

    // animate();

    function animate() {

        requestAnimationFrame(animate);

        for (var i = 0; i < NUMDRAW; i++) {
            sprites[i].rotation += 0.4;
        }

        console.time('render');
        renderer.render(container);
        console.timeEnd('render');
    }
    </script>
</body>

</html>
